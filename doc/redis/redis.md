

## redis 总结


### redis是单线程的

* redis5.0版本后会是双线程



### redis持久化策略

* redis 会加载磁盘持久化文件 （第一次启动是没有持久化文件）

* 持久化文件存储的目录可以在redis.conf配置 dump.rdb

* 如果没有开启aof，关闭redis

#### RDB持久化策略 默认开启

    save 900 1    ====有1个key发生变化，900秒后进行持久化
    save 300 10   ====有10个key发生变化，300秒后进行持久化
    save 60 10000 ====有10000个key发生变化，60秒后进行持久化

* RDB持久化策略会frok子进程

#### AOF持久化策略 （追加redis的写入命令的日志文件） AOF （默认不开启）（写一次，备份一次 保证数据强一致性、稳健、效率低）

* 开启aof：设置yes,修改默认的appendonly no,改为yes

* 每修改同步：appendfsync always 同步持久化 每次发生数据变更会被立即记录到磁盘 性能较差但数据完整性比较好

* 每秒同步：appendfsync everysec 异步操作，每秒记录 如果有一秒内宕机，有数据丢失

* 不同步：appendfsync no 从不同步

* 开启aof直接


### RDB 与 AOF 区别

- 相同数据集的数据而言aof文件要远大于rdb文件，恢复速度慢于rdb

- aof运行效率要慢于rdb，

- 每秒同步策略效率较好，

- 不同步效率和rdb相同

- 重写是根据aof文件大和 aof大小比例 （重写时会frok子进程）


### 持久化优化总结



### 缓存穿透、缓存击穿、缓存雪崩


* 缓存穿透  使用缓存提升性能----减轻数据压力

    - 查询数据和缓存都没有的数据（缓存穿透）

    - 解决方案：缓存空对象   代码简单 --- 效果一般 --- 空对象多的话占用redis缓存  （空对象设计一个没有属性的对象）

    - 解决方案：布隆过滤器   代码复杂 --- 效果好

    - 手写布隆过滤器（位数组长度、hash个数会自动计算）












